# Debezium Connect Log4j Configuration
# Custom configuration with proper log rotation and cleanup

kafka.logs.dir=logs

# Root logger: DEBUG to both console and file
log4j.rootLogger=${LOG_LEVEL:-INFO}, stdout, connectlog

# Disable excessive reflection warnings - KAFKA-5229
log4j.logger.org.reflections=ERROR

# ============================================
# Console Appender (captured by Docker logging)
# ============================================
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.threshold=${LOG_LEVEL:-INFO}
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{ISO8601} %-5p  %X{dbz.connectorType}|%X{dbz.connectorName}|%X{dbz.connectorContext}  %m   [%c]%n

# ============================================
# Rolling File Appender (with cleanup!)
# ============================================
# Uses RollingFileAppender instead of DailyRollingFileAppender
# Key difference: MaxBackupIndex limits the number of backup files
log4j.appender.connectlog=org.apache.log4j.RollingFileAppender
log4j.appender.connectlog.File=${kafka.logs.dir}/connect-service.log
log4j.appender.connectlog.MaxFileSize=100MB
log4j.appender.connectlog.MaxBackupIndex=5
log4j.appender.connectlog.layout=org.apache.log4j.PatternLayout
log4j.appender.connectlog.layout.ConversionPattern=%d{ISO8601} %-5p  %X{dbz.connectorType}|%X{dbz.connectorName}|%X{dbz.connectorContext}  %m   [%c]%n

# ============================================
# Component-specific log levels
# ============================================
# Reduce noise from chatty components
log4j.logger.org.apache.kafka=WARN
log4j.logger.org.apache.kafka.connect.runtime.WorkerSourceTask=INFO
log4j.logger.org.apache.kafka.connect.runtime.WorkerSinkTask=INFO
log4j.logger.io.debezium=INFO
log4j.logger.io.debezium.connector=INFO
